// Code generated by Wire. DO NOT EDIT.

//go:generate go run github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package cli

import (
	"context"
	"github.com/harness/runner/cli/server"
	"github.com/harness/runner/delegateshell"
	"github.com/harness/runner/delegateshell/client"
	"github.com/harness/runner/delegateshell/daemonset"
	"github.com/harness/runner/delegateshell/delegate"
	"github.com/harness/runner/delegateshell/heartbeat"
	"github.com/harness/runner/delegateshell/poller"
	"github.com/harness/runner/delegateshell/vm/metrics"
	"github.com/harness/runner/delegateshell/vm/pool"
	"github.com/harness/runner/delegateshell/vm/store"
	"github.com/harness/runner/metrics/injection"
	"github.com/harness/runner/router"
)

// Injectors from wire.go:

func initSystem(ctx context.Context, config *delegate.Config) (*server.System, error) {
	clientClient := client.ProvideManagerClient(config)
	downloader, err := delegateshell.ProvideDownloader()
	if err != nil {
		return nil, err
	}
	daemonSetManager := daemonset.ProvideDaemonSetManager(config, downloader)
	db, err := store.ProvideSQLDatabase(config)
	if err != nil {
		return nil, err
	}
	instanceStore := store.ProvideInstanceStore(db)
	stageOwnerStore := store.ProvideStageOwnerStore(db)
	iManager := pool.ProvideManager(ctx, instanceStore, stageOwnerStore, config)
	metricsMetrics := metricsinjection.ProvideMetricsClient(config)
	metricMetrics, err := metrics.ProvideVMMetrics(metricsMetrics)
	if err != nil {
		return nil, err
	}
	taskRouter := router.ProvideRouter(config, downloader, daemonSetManager, iManager, stageOwnerStore, metricMetrics)
	daemonSetReconciler := daemonset.ProvideDaemonSetReconciler(daemonSetManager, taskRouter, clientClient, metricsMetrics)
	pollerPoller := poller.ProvidePoller(clientClient, taskRouter, config, metricsMetrics)
	keepAlive := heartbeat.ProvideKeepAlive(config, clientClient, metricsMetrics)
	delegateShell := delegateshell.ProvideDelegateShell(config, clientClient, taskRouter, daemonSetManager, daemonSetReconciler, downloader, pollerPoller, keepAlive)
	metricsHandler := metricsinjection.ProvideMetricsHandler(config)
	system := server.NewSystem(delegateShell, iManager, metricsHandler)
	return system, nil
}
